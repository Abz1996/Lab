pipeline {
    agent any

    parameters {
        string(name: 'GIT_REPO_URL', defaultValue: 'https://github.com/Abz1996/Lab.git', description: 'Git repository URL')
        string(name: 'GIT_BRANCH', defaultValue: 'main', description: 'Git branch name')
        string(name: 'DeployEnvironment', defaultValue: '', description: 'Environment to deploy (QA or Production)')
        string(name: 'AppPort', defaultValue: '8081', description: 'Port for the application')
    }

 

    environment {
        registry = "abz1996/petclinic-java" // Docker image name
        registryCredential = 'Docker_token' // Jenkins credential ID for DockerHub
        dockerImage = '' // Placeholder for Docker image object
        dockerTag = "${env.BUILD_NUMBER}" // Use build number as Docker tag
        DOCKER_IMAGE_NAME = "${registry}:${dockerTag}" // Docker image name to be used in deployment
    }

     stages {
        stage('Build Docker Image') {
            steps {
                dir('petclinic-app') {
                    script {
                        echo "Building Docker image: ${registry}:${dockerTag}"
                        dockerImage = docker.build("${registry}:${dockerTag}") // Build the Docker image with the build number as the tag
                    }
                }
            }
        }
     }
}   
        

        